mysql> USE test;
Database changed
mysql> CREATE TABLE book(
    ->     book_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     title VARCHAR(50),
    ->     author VARCHAR(30),
    ->     price DECIMAL(8, 2),
    ->     amount INT
    ->     );
Query OK, 0 rows affected (0.02 sec)

mysql> DESC book;
+---------+--------------+------+-----+---------+----------------+
| Field   | Type         | Null | Key | Default | Extra          |
+---------+--------------+------+-----+---------+----------------+
| book_id | int          | NO   | PRI | NULL    | auto_increment |
| title   | varchar(50)  | YES  |     | NULL    |                |
| author  | varchar(30)  | YES  |     | NULL    |                |
| price   | decimal(8,2) | YES  |     | NULL    |                |
| amount  | int          | YES  |     | NULL    |                |
+---------+--------------+------+-----+---------+----------------+
5 rows in set (0.01 sec)

mysql> INSERT INTO book (title, author, price, amount)
    ->     VALUE ('Мастер и Маргарита', 'Булгаков М.А.', 670.99, 3);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM book;
+---------+--------------------+---------------+--------+--------+
| book_id | title              | author        | price  | amount |
+---------+--------------------+---------------+--------+--------+
|       1 | Мастер и Маргарита | Булгаков М.А. | 670.99 |      3 |
+---------+--------------------+---------------+--------+--------+
1 row in set (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    ->     VALUE ('Белая гвардия', 'Булгаков М.А.', 540.50, 5);
Query OK, 1 row affected (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    ->     VALUE ('Идиот', 'Достоевский Ф.М.', 460.00, 10);
Query OK, 1 row affected (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    ->     VALUE ('Братья Карамазовы', 'Достоевский Ф.М.', 799.01, 2);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM book;
+---------+--------------------+------------------+--------+--------+
| book_id | title              | author           | price  | amount |
+---------+--------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия      | Булгаков М.А.    | 540.50 |      5 |
|       3 | Идиот              | Достоевский Ф.М. | 460.00 |     10 |
|       4 | Братья Карамазовы  | Достоевский Ф.М. | 799.01 |      2 |
+---------+--------------------+------------------+--------+--------+
4 rows in set (0.00 sec)

Задание
Выбрать авторов, название книг и их цену из таблицы book.

mysql> SELECT author, title, price FROM book;
+------------------+--------------------+--------+
| author           | title              | price  |
+------------------+--------------------+--------+
| Булгаков М.А.    | Мастер и Маргарита | 670.99 |
| Булгаков М.А.    | Белая гвардия      | 540.50 |
| Достоевский Ф.М. | Идиот              | 460.00 |
| Достоевский Ф.М. | Братья Карамазовы  | 799.01 |
+------------------+--------------------+--------+
4 rows in set (0.00 sec)

Задание
Выбрать названия книг и авторов из таблицы book, для поля title задать имя(псевдоним) 
Название, для поля author –Автор. 

mysql> SELECT title AS Название, author AS Автор
    ->     FROM book;
+--------------------+------------------+
| Название           | Автор            |
+--------------------+------------------+
| Мастер и Маргарита | Булгаков М.А.    |
| Белая гвардия      | Булгаков М.А.    |
| Идиот              | Достоевский Ф.М. |
| Братья Карамазовы  | Достоевский Ф.М. |
+--------------------+------------------+
4 rows in set (0.00 sec)

Задание
Для упаковки каждой книги требуется один лист бумаги, цена которого 1 рубль 65 копеек. 
Посчитать стоимость упаковки для каждой книги (сколько денег потребуется, чтобы упаковать все экземпляры книги). 
В запросе вывести название книги, ее количество и стоимость упаковки, последний столбец назвать pack.

mysql> SELECT title, amount, amount * 1.65 AS pack
    -> FROM book;
+--------------------+--------+-------+
| title              | amount | pack  |
+--------------------+--------+-------+
| Мастер и Маргарита |      3 |  4.95 |
| Белая гвардия      |      5 |  8.25 |
| Идиот              |     10 | 16.50 |
| Братья Карамазовы  |      2 |  3.30 |
+--------------------+--------+-------+
4 rows in set (0.00 sec)

Задание
В конце года цену всех книг на складе пересчитывают – снижают ее на 30%. 
Написать SQL запрос, который из таблицы book выбирает названия, 
авторов, количества и вычисляет новые цены книг. 
Столбец с новой ценой назвать new_price, цену округлить до 2-х знаков после запятой.

mysql> SELECT title, author, amount,
    ->     ROUND ((price*0.7),2) AS new_price
    -> FROM book;
+--------------------+------------------+--------+-----------+
| title              | author           | amount | new_price |
+--------------------+------------------+--------+-----------+
| Мастер и Маргарита | Булгаков М.А.    |      3 |    469.69 |
| Белая гвардия      | Булгаков М.А.    |      5 |    378.35 |
| Идиот              | Достоевский Ф.М. |     10 |    322.00 |
| Братья Карамазовы  | Достоевский Ф.М. |      2 |    559.31 |
+--------------------+------------------+--------+-----------+
4 rows in set (0.00 sec)

Задание
Вывести автора, название  и цены тех книг, количество которых меньше 10.

mysql> SELECT author, title, price
    -> FROM book
    -> WHERE amount<10;
+------------------+--------------------+--------+
| author           | title              | price  |
+------------------+--------------------+--------+
| Булгаков М.А.    | Мастер и Маргарита | 670.99 |
| Булгаков М.А.    | Белая гвардия      | 540.50 |
| Достоевский Ф.М. | Братья Карамазовы  | 799.01 |
+------------------+--------------------+--------+
3 rows in set (0.00 sec)

Задание
Вывести название и авторов тех книг, цены которых принадлежат интервалу 
от 540.50 до 800 (включая границы),  
а количество или 2, или 3, или 5, или 7 .

mysql> SELECT title, author
    -> FROM book
    -> WHERE (price BETWEEN 540.50 AND 800) AND amount BETWEEN 2 AND 3 OR amount=5 OR amount=7;
+--------------------+------------------+
| title              | author           |
+--------------------+------------------+
| Мастер и Маргарита | Булгаков М.А.    |
| Белая гвардия      | Булгаков М.А.    |
| Братья Карамазовы  | Достоевский Ф.М. |
+--------------------+------------------+
3 rows in set (0.00 sec)

Задание
Вывести  автора и название  книг, количество которых принадлежит интервалу от 2 до 14 (включая границы). 
Информацию  отсортировать сначала по авторам (в обратном алфавитном порядке), 
а затем по названиям книг (по алфавиту).

mysql> SELECT author, title
    -> FROM book
    -> WHERE amount BETWEEN 2 AND 14
    -> ORDER BY author DESC, title;
+------------------+--------------------+
| author           | title              |
+------------------+--------------------+
| Достоевский Ф.М. | Братья Карамазовы  |
| Достоевский Ф.М. | Идиот              |
| Булгаков М.А.    | Белая гвардия      |
| Булгаков М.А.    | Мастер и Маргарита |
+------------------+--------------------+
4 rows in set (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    -> VALUE ('Стихотворения и лирика', 'Есенин С.А.', 650.00, 15);
Query OK, 1 row affected (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    -> VALUE ('Капитанская дочка', 'Пушкин А.С.', 520.50, 7);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 540.50 |      5 |
|       3 | Идиот                  | Достоевский Ф.М. | 460.00 |     10 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 520.50 |      7 |
+---------+------------------------+------------------+--------+--------+
6 rows in set (0.00 sec)

Задание
Вывести название и автора тех книг, название которых состоит из двух и более слов, а инициалы автора содержат букву «С». 
Считать, что в названии слова отделяются друг от друга пробелами и не содержат знаков препинания, 
между фамилией автора и инициалами обязателен пробел, инициалы записываются без пробела в формате: 
буква, точка, буква, точка. 
Информацию отсортировать по названию книги в алфавитном порядке.

mysql> SELECT title, author
    -> FROM book
    -> WHERE title LIKE '_% _%'
    ->     AND (author LIKE '% С._.' OR author LIKE '% _.С.')
    -> ORDER BY title;
+------------------------+-------------+
| title                  | author      |
+------------------------+-------------+
| Капитанская дочка      | Пушкин А.С. |
| Стихотворения и лирика | Есенин С.А. |
+------------------------+-------------+
2 rows in set (0.00 sec)

mysql> INSERT INTO book (title, author, price, amount)
    -> VALUE ('Игрок', 'Достоевский Ф.М.', 480.50, 10);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 540.50 |      5 |
|       3 | Идиот                  | Достоевский Ф.М. | 460.00 |     10 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 520.50 |      7 |
|       7 | Игрок                  | Достоевский Ф.М. | 480.50 |     10 |
+---------+------------------------+------------------+--------+--------+
7 rows in set (0.00 sec)

Задание
Отобрать различные (уникальные) элементы столбца amount таблицы book.

mysql> SELECT amount
    -> FROM book
    -> GROUP BY amount;
+--------+
| amount |
+--------+
|      3 |
|      5 |
|     10 |
|      2 |
|     15 |
|      7 |
+--------+
6 rows in set (0.00 sec)

Задание
Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  
Столбцы назвать Автор, Различных_книг и Количество_экземпляров соответственно.

mysql> SELECT author AS 'Автор', COUNT(amount) AS 'Различных_книг', SUM(amount) AS 'Количество_экземпляров'
    -> FROM book
    -> GROUP BY author;
+------------------+----------------+------------------------+
| Автор            | Различных_книг | Количество_экземпляров |
+------------------+----------------+------------------------+
| Булгаков М.А.    |              2 |                      8 |
| Достоевский Ф.М. |              3 |                     22 |
| Есенин С.А.      |              1 |                     15 |
| Пушкин А.С.      |              1 |                      7 |
+------------------+----------------+------------------------+
4 rows in set (0.00 sec)

Задание
Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . 
Вычисляемые столбцы назвать Минимальная_цена, Максимальная_цена и Средняя_цена соответственно.

mysql> SELECT author, MIN(price) AS 'Минимальная_цена', MAX(price) AS 'Максимальная_цена', AVG(price) AS 'Средняя_цена'
    -> FROM book
    -> GROUP BY author;
+------------------+------------------+-------------------+--------------+
| author           | Минимальная_цена | Максимальная_цена | Средняя_цена |
+------------------+------------------+-------------------+--------------+
| Булгаков М.А.    |           540.50 |            670.99 |   605.745000 |
| Достоевский Ф.М. |           460.00 |            799.01 |   579.836667 |
| Есенин С.А.      |           650.00 |            650.00 |   650.000000 |
| Пушкин А.С.      |           520.50 |            520.50 |   520.500000 |
+------------------+------------------+-------------------+--------------+
4 rows in set (0.00 sec)

Задание
Для каждого автора вычислить суммарную стоимость книг S (имя столбца Стоимость), а 
также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца НДС ) , 
который включен в стоимость и составляет k = 18%,  а также стоимость книг  (Стоимость_без_НДС) без него. 
Значения округлить до двух знаков после запятой. В запросе для расчета НДС(tax)  и 
Стоимости без НДС(S_without_tax) использовать следующие формулы:

tax=(S*k/100)/(1+k/100)
S without tax=S/(1+k/100)

mysql> SELECT author, ROUND(SUM(price*amount),2) AS Стоимость,
    ->     ROUND(SUM((price*amount*0.18)/(1+0.18)),2) AS НДС,
    ->     ROUND(SUM(price*amount/(1+0.18)),2) AS Стоимость_без_НДС
    -> FROM book
    -> GROUP BY author;
+------------------+-----------+---------+-------------------+
| author           | Стоимость | НДС     | Стоимость_без_НДС |
+------------------+-----------+---------+-------------------+
| Булгаков М.А.    |   4715.47 |  719.31 |           3996.16 |
| Достоевский Ф.М. |  11003.02 | 1678.43 |           9324.59 |
| Есенин С.А.      |   9750.00 | 1487.29 |           8262.71 |
| Пушкин А.С.      |   3643.50 |  555.79 |           3087.71 |
+------------------+-----------+---------+-------------------+
4 rows in set (0.00 sec)

Задание
Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену уникальных книг на складе. 
Названия столбцов Минимальная_цена, Максимальная_цена, Средняя_цена соответственно. 
Среднюю цену округлить до двух знаков после запятой.

mysql> SELECT DISTINCT MIN(price) AS Минимальная_цена, MAX(price) AS Максимальная_цена, ROUND(AVG(price),2) AS Средняя_цена
    -> FROM book;
+------------------+-------------------+--------------+
| Минимальная_цена | Максимальная_цена | Средняя_цена |
+------------------+-------------------+--------------+
|           460.00 |            799.01 |       588.79 |
+------------------+-------------------+--------------+
1 row in set (0.00 sec)

Задание
Вычислить среднюю цену и суммарную стоимость тех книг, 
количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. 
Столбцы назвать Средняя_цена и Стоимость, значения округлить до 2-х знаков после запятой.

mysql> SELECT ROUND(AVG(price),2) AS Средняя_цена,
    ->        SUM(price*amount) AS Стоимость
    -> FROM book
    -> WHERE amount BETWEEN 5 AND 14;
+--------------+-----------+
| Средняя_цена | Стоимость |
+--------------+-----------+
|       500.38 |  15751.00 |
+--------------+-----------+
1 row in set (0.00 sec)


Задание
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». 
В результат включить только тех авторов, у которых суммарная стоимость книг 
(без учета книг «Идиот» и «Белая гвардия») более 5000 руб. 
Вычисляемый столбец назвать Стоимость. Результат отсортировать по убыванию стоимости.

mysql> SELECT author,
    ->     SUM(price*amount) AS Стоимость
    -> FROM book
    -> WHERE title <> 'Идиот' AND title <> 'Белая гвардия'
    -> GROUP BY author
    -> HAVING SUM(price*amount) > 5000
    -> ORDER BY author DESC;
+------------------+-----------+
| author           | Стоимость |
+------------------+-----------+
| Есенин С.А.      |   9750.00 |
| Достоевский Ф.М. |   6403.02 |
+------------------+-----------+
2 rows in set (0.00 sec)

Задание
Вывести информацию (автора, название и цену) о  книгах, цены которых меньше или равны средней цене книг на складе. 
Информацию вывести в отсортированном по убыванию цены виде. 
Среднее вычислить как среднее по цене книги.

mysql> SELECT author, title, price
    -> FROM book
    -> WHERE price <= (SELECT AVG(price) FROM book)
    -> ORDER BY price DESC;
+------------------+-------------------+--------+
| author           | title             | price  |
+------------------+-------------------+--------+
| Булгаков М.А.    | Белая гвардия     | 540.50 |
| Пушкин А.С.      | Капитанская дочка | 520.50 |
| Достоевский Ф.М. | Игрок             | 480.50 |
| Достоевский Ф.М. | Идиот             | 460.00 |
+------------------+-------------------+--------+
4 rows in set (0.00 sec)

Задание
Вывести информацию (автора, название и цену) о тех книгах, цены которых превышают минимальную цену книги 
на складе не более чем на 150 рублей в отсортированном по возрастанию цены виде.

mysql> SELECT author, title, price
    -> FROM book
    -> WHERE (price - (SELECT MIN(price) FROM book)) <= 150
    -> ORDER BY price;
+------------------+-------------------+--------+
| author           | title             | price  |
+------------------+-------------------+--------+
| Достоевский Ф.М. | Идиот             | 460.00 |
| Достоевский Ф.М. | Игрок             | 480.50 |
| Пушкин А.С.      | Капитанская дочка | 520.50 |
| Булгаков М.А.    | Белая гвардия     | 540.50 |
+------------------+-------------------+--------+
4 rows in set (0.00 sec)

Задание
Вывести информацию (автора, книгу и количество) о тех книгах, количество экземпляров которых в таблице book не дублируется.

mysql> SELECT author, title, amount
    -> FROM book
    -> WHERE amount IN (
    -> SELECT amount
    -> FROM book
    -> GROUP by amount
    -> HAVING count(amount)=1);
+------------------+------------------------+--------+
| author           | title                  | amount |
+------------------+------------------------+--------+
| Булгаков М.А.    | Мастер и Маргарита     |      3 |
| Булгаков М.А.    | Белая гвардия          |      5 |
| Достоевский Ф.М. | Братья Карамазовы      |      2 |
| Есенин С.А.      | Стихотворения и лирика |     15 |
| Пушкин А.С.      | Капитанская дочка      |      7 |
+------------------+------------------------+--------+
5 rows in set (0.00 sec)

Задание
Вывести информацию о книгах(автор, название, цена), 
цена которых меньше самой большой из минимальных цен, вычисленных для каждого автора.

mysql> SELECT author, title, price
    -> FROM book
    -> WHERE price < ANY (SELECT MIN(price) FROM book GROUP BY author);
+------------------+-------------------+--------+
| author           | title             | price  |
+------------------+-------------------+--------+
| Булгаков М.А.    | Белая гвардия     | 540.50 |
| Достоевский Ф.М. | Идиот             | 460.00 |
| Пушкин А.С.      | Капитанская дочка | 520.50 |
| Достоевский Ф.М. | Игрок             | 480.50 |
+------------------+-------------------+--------+
4 rows in set (0.00 sec)


mysql> CREATE TABLE supply (
    ->     supply_id INT PRIMARY KEY AUTO_INCREMENT,
    ->     title VARCHAR(50),
    ->     author VARCHAR(30),
    ->     price DECIMAL(8, 2),
    ->     amount INT);
Query OK, 0 rows affected (0.02 sec)

mysql> INSERT INTO supply (title, author, price, amount)
    -> VALUES
    ->     ('Лирика', 'Пастернак Б.Л.', 518.99, 2),
    ->     ('Черный человек', 'Есенин С.А.', 570.20, 6),
    ->     ('Белая гвардия', 'Булгаков М.А.', 540.50, 7),
    ->     ('Идиот', 'Достоевский Ф.М.', 360.80, 3);
Query OK, 4 rows affected (0.01 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM supply;
+-----------+----------------+------------------+--------+--------+
| supply_id | title          | author           | price  | amount |
+-----------+----------------+------------------+--------+--------+
|         1 | Лирика         | Пастернак Б.Л.   | 518.99 |      2 |
|         2 | Черный человек | Есенин С.А.      | 570.20 |      6 |
|         3 | Белая гвардия  | Булгаков М.А.    | 540.50 |      7 |
|         4 | Идиот          | Достоевский Ф.М. | 360.80 |      3 |
+-----------+----------------+------------------+--------+--------+
4 rows in set (0.00 sec)

Задание
Добавить из таблицы supply в таблицу book, все книги, кроме книг, написанных Булгаковым М.А. и Достоевским Ф.М.

mysql> INSERT INTO book (title, author, price, amount)
    -> SELECT title, author, price, amount
    -> FROM supply
    -> WHERE NOT author='Булгаков М.А.' AND NOT author='Достоевский Ф.М.';
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql>
mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 540.50 |      5 |
|       3 | Идиот                  | Достоевский Ф.М. | 460.00 |     10 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 520.50 |      7 |
|       7 | Игрок                  | Достоевский Ф.М. | 480.50 |     10 |
|       8 | Лирика                 | Пастернак Б.Л.   | 518.99 |      2 |
|       9 | Черный человек         | Есенин С.А.      | 570.20 |      6 |
+---------+------------------------+------------------+--------+--------+
9 rows in set (0.00 sec)

Задание
Занести из таблицы supply в таблицу book только те книги, авторов которых нет в  book.

mysql> INSERT INTO book (title, author, price, amount)
    -> SELECT title, author, price, amount
    -> FROM supply
    -> WHERE author NOT IN (
    ->         SELECT author
    ->         FROM book);
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql>
mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 540.50 |      5 |
|       3 | Идиот                  | Достоевский Ф.М. | 460.00 |     10 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 520.50 |      7 |
|       7 | Игрок                  | Достоевский Ф.М. | 480.50 |     10 |
|       8 | Лирика                 | Пастернак Б.Л.   | 518.99 |      2 |
|       9 | Черный человек         | Есенин С.А.      | 570.20 |      6 |
+---------+------------------------+------------------+--------+--------+
9 rows in set (0.00 sec)

Задание
Уменьшить на 10% цену тех книг в таблице book, количество которых принадлежит интервалу от 5 до 10, включая границы.

mysql> UPDATE book
    -> SET price = 0.9*price
    -> WHERE amount BETWEEN 5 AND 10;
Query OK, 5 rows affected (0.00 sec)
Rows matched: 5  Changed: 5  Warnings: 0

mysql>
mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 486.45 |      5 |
|       3 | Идиот                  | Достоевский Ф.М. | 414.00 |     10 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 468.45 |      7 |
|       7 | Игрок                  | Достоевский Ф.М. | 432.45 |     10 |
|       8 | Лирика                 | Пастернак Б.Л.   | 518.99 |      2 |
|       9 | Черный человек         | Есенин С.А.      | 513.18 |      6 |
+---------+------------------------+------------------+--------+--------+
9 rows in set (0.00 sec)

Задание
Для тех книг в таблице book , которые есть в таблице supply, не только увеличить их количество в таблице book 
( увеличить их количество на значение столбца amountтаблицы supply), но и пересчитать их цену 
(для каждой книги найти сумму цен из таблиц book и supply и разделить на 2)

mysql> UPDATE book, supply
    -> SET book.amount=book.amount + supply.amount,
    -> book.price=(book.price + supply.price)/2
    -> WHERE book.title = supply.title AND book.author = supply.author;
Query OK, 4 rows affected, 1 warning (0.00 sec)
Rows matched: 4  Changed: 4  Warnings: 1

mysql>
mysql> SELECT * FROM book;
+---------+------------------------+------------------+--------+--------+
| book_id | title                  | author           | price  | amount |
+---------+------------------------+------------------+--------+--------+
|       1 | Мастер и Маргарита     | Булгаков М.А.    | 670.99 |      3 |
|       2 | Белая гвардия          | Булгаков М.А.    | 513.48 |     12 |
|       3 | Идиот                  | Достоевский Ф.М. | 387.40 |     13 |
|       4 | Братья Карамазовы      | Достоевский Ф.М. | 799.01 |      2 |
|       5 | Стихотворения и лирика | Есенин С.А.      | 650.00 |     15 |
|       6 | Капитанская дочка      | Пушкин А.С.      | 468.45 |      7 |
|       7 | Игрок                  | Достоевский Ф.М. | 432.45 |     10 |
|       8 | Лирика                 | Пастернак Б.Л.   | 518.99 |      4 |
|       9 | Черный человек         | Есенин С.А.      | 541.69 |     12 |
+---------+------------------------+------------------+--------+--------+
9 rows in set (0.00 sec)

Задание
Удалить из таблицы supply книги тех авторов, общее количество экземпляров книг которых в таблице book превышает 10.

mysql> DELETE FROM supply
    -> WHERE author IN(
    ->      SELECT author
    ->      FROM book
    ->      GROUP BY author
    ->      HAVING SUM(amount) > 10
    ->      );
Query OK, 3 rows affected (0.00 sec)

mysql> SELECT * FROM supply;
+-----------+--------+----------------+--------+--------+
| supply_id | title  | author         | price  | amount |
+-----------+--------+----------------+--------+--------+
|         1 | Лирика | Пастернак Б.Л. | 518.99 |      2 |
+-----------+--------+----------------+--------+--------+
1 row in set (0.00 sec)





